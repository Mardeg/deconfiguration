<!DOCTYPE html>
<html lang="en">
<!-- Licensed under the Academic Free License version 3.0
	- Any copyright dedicated to the public domain -->
	<head vocab="https://schema.org/DigitalDocument">
		<link rel="license nofollow schema:license" href="https://spdx.org/licenses/AFL-3.0">
		<link rel="license nofollow schema:license" href="https://creativecommons.org/publicdomain/zero/1.0/">
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<meta http-equiv="Content-Security-Policy" content="base-uri 'self'; form-action 'none'; object-src 'none'; media-src 'self' data:; img-src 'self' data:; child-src blob: https://web.archive.org; style-src 'self' 'unsafe-inline'; connect-src 'self' blob: data:">
		<meta name="mobile-web-app-capable" content="yes">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title property="headline">Cisco Nexus C9336PQ (ACI mode)</title>
		<meta name="description" content="How to factory reset instructions tutorial guide">
		<link rel="icon" href="data:image/svg+xml;charset=utf-8;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48dGV4dCB5PSIuOWVtIiBmb250LXNpemU9IjkwIj7wn5K7PC90ZXh0Pjwvc3ZnPg==">
    <style>
    :root,h1 {background-color:#CCC}
    :root {
      color:#000;
      background-image:url("data:image/svg+xml;charset=utf-8;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+DQo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgaGVpZ2h0PSI0MDAiIHdpZHRoPSI1MjUiPg0KPGZvcmVpZ25PYmplY3QgaGVpZ2h0PSIxMDAlIiB3aWR0aD0iMTAwJSIgeD0iLTI0IiB5PSItMzciIHJlcXVpcmVkRXh0ZW5zaW9ucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCI+DQo8Ym9keSB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIgc3R5bGU9InBhZGRpbmc6MWVtIj4NCjxwcmUgc3R5bGU9ImNvbG9yOmRhcmtncmVlbjtvcGFjaXR5OjAuMTt3aWR0aDpmaXQtY29udGVudCI+DQogICAgICAgICAgICAgICAgICAgICMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIw0KICAgICAgICAgICAgICAgICAgICMjIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyMjDQogICAgICAgICAgICAgICAgICAgIyMjICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIyMNCiAgICAgICAgICAgICAgICAgICAjIyMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMjIw0KICAgICAgICAgICAgIyAgICAgICMjIyAgICAgICMgICAgICAgICAgICAgICAjICAgICAgIyMjICAgICAgIw0KICAgICAgICAgICAjIyMgICAgICMjIyAgICAgIyMjICAgICAgICAgICAgICMjIyAgICAgIyMjICAgICAjIyMNCiAgICAjICAgICAgIyMjICAgICAjIyMgICAgICMjIyAgICAgICMgICAgICAjIyMgICAgICMjIyAgICAgIyMjICAgICAgIw0KICAgIyMjICAgICAjIyMgICAgICMjIyAgICAgIyMjICAgICAjIyMgICAgICMjIyAgICAgIyMjICAgICAjIyMgICAgICMjIyAgDQogICAjIyMgICAgICMjIyAgICAgIyMjICAgICAjIyMgICAgICMjIyAgICAgIyMjICAgICAjIyMgICAgICMjIyAgICAgIyMjICANCiAgICMjIyAgICAgIyMjICAgICAjIyMgICAgICMjIyAgICAgIyMjICAgICAjIyMgICAgICMjIyAgICAgIyMjICAgICAjIyMgIA0KICAgICMgICAgICAgIyAgICAgICMjIyAgICAgICMgICAgICAgIyAgICAgICAjICAgICAgIyMjICAgICAgIyAgICAgICAjDQogICAgICAgICAgICAgICAgICAgIyMjICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIyMNCiAgICAgICAgICAgICAgICAgICAjIyMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMjIw0KICAgICAgICAgICAgICAgICAgICAjICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMNCg0KDQogICAgICAgICAgICAjIyMjIyMjICAgIyMjICAgICMjIyMjIyMgICAgICAgIyMjIyMjIyAgICAgICMjIyMjDQogICAgICAgICAgIyMjIyMjIyMjICAgIyMjICAgIyMjICAgICMjICAgICMjIyMjIyMjIyAgICAjIyMjIyMjIyMNCiAgICAgICAgICMjIyAgICAgICAgICAjIyMgICAgIyMjIyAgICAgICAjIyMgICAgICAgICAgIyMjICAgICAjIyMNCiAgICAgICAgICMjIyAgICAgICAgICAjIyMgICAgICAjIyMgICAgICAjIyMgICAgICAgICAgIyMjICAgICAjIyMNCiAgICAgICAgICMjIyAgICAgICAgICAjIyMgICAgICAgIyMjIyAgICAjIyMgICAgICAgICAgIyMjICAgICAjIyMNCiAgICAgICAgICAjIyMjIyMjIyMgICAjIyMgICAjIyAgICAjIyMgICAgIyMjIyMjIyMjICAgICMjIyMjIyMjIw0KICAgICAgICAgICAgIyMjIyMjIyAgICMjIyAgICAjIyMjIyMjICAgICAgICMjIyMjIyMgICAgICAjIyMjIw0KDQo8L3ByZT48L2JvZHk+PC9mb3JlaWduT2JqZWN0Pjwvc3ZnPg==");
      background-repeat:no-repeat;
      background-size:100vw 100vh;
      background-attachment:fixed;
    }
    h1 {position:sticky;top:0;width:fit-content;text-decoration:dashed underline #CCCCCC 8px;padding-right:0.2ex;z-index:1}
    ol > li {padding-bottom:1em}
    ol > li::marker {font-weight:bold}
    h2 {font-variant:small-caps;font-size:large;font-weight:normal;display:inline}
    blockquote,summary samp{background-color:rgba(0,0,0,0.75);color:#FFF}
    blockquote > samp {color:#FFF}
    blockquote {
                  overflow-x:clip;
                  overflow-clip-margin:9vw; /* https://github.com/w3c/css-validator/issues/418 */
                  padding-left:0.5ex;
                  margin-top:0.5ex;
                  white-space:pre;
    } 
    blockquote span {color:yellow}
    .cyan {color:cyan}
    summary {list-style-image: url("data:image/svg+xml;charset=utf-8;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyZXgiIGhlaWdodD0iMmV4Ij48c3R5bGU+DQovKiA8IVtDREFUQVsgKi8NCnN2Z3tiYWNrZ3JvdW5kLWltYWdlOnJhZGlhbC1ncmFkaWVudCh3aGl0ZSx3aGl0ZSxyZ2JhKDI1NSwyNTUsMjU1LDApLHJnYmEoMjU1LDI1NSwyNTUsMCkscmdiYSgyNTUsMjU1LDI1NSwwKSl9DQovKiBdXT4gKi8NCjwvc3R5bGU+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGRvbWluYW50LWJhc2VsaW5lPSJjZW50cmFsIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LXNpemU9IjJleCI+4piQPC90ZXh0Pg0KPHRleHQgeD0iNjUlIiB5PSIzMyUiIGRvbWluYW50LWJhc2VsaW5lPSJjZW50cmFsIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LXNpemU9IjIuNWV4IiBmaWxsPSIjMDA3NzAwIj7inJM8L3RleHQ+DQo8L3N2Zz4=")}
    summary:focus {list-style-image: unset;list-style-type: "\27A4\00A0\00A0";}
    li:focus-within > details:focus-within ~ details > summary,li:focus-within ~ li summary,ol:not(:focus-within) summary {list-style-image: url("data:image/svg+xml;charset=utf-8;charset=utf-8;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyZXgiIGhlaWdodD0iMmV4Ij48c3R5bGU+DQovKiA8IVtDREFUQVsgKi8NCnN2Z3tiYWNrZ3JvdW5kLWltYWdlOnJhZGlhbC1ncmFkaWVudCh3aGl0ZSx3aGl0ZSxyZ2JhKDI1NSwyNTUsMjU1LDApLHJnYmEoMjU1LDI1NSwyNTUsMCkscmdiYSgyNTUsMjU1LDI1NSwwKSl9DQovKiBdXT4gKi8NCjwvc3R5bGU+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGRvbWluYW50LWJhc2VsaW5lPSJjZW50cmFsIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LXNpemU9IjJleCI+4piQPC90ZXh0Pjwvc3ZnPg==");}
    summary[tabindex="0"][property$="t"]:hover {list-style-image: unset;list-style-type: "\25A0\00A0\00A0";}
    li:focus-within > h2 {filter:drop-shadow(0.09ex 0.09ex 0.12ex);text-decoration:white 1px underline;animation: 0.5s infinite alternate underpulse}
    details[open] > summary:active {pointer-events:none}
    summary:focus::marker,summary:hover::marker {animation: 0.5s infinite alternate pulsate}
    @keyframes pulsate {
      from {color:#008;}
      to {color:#FFF;}
    }
    @keyframes underpulse {
      from {text-decoration-style:solid;}
      25% {text-decoration-style:solid;}
      to {text-decoration-style:dotted;}
    }
    </style>
</head>
<body><main vocab="http://schema.org/" typeof="HowTo">
	<h1 property="name">Cisco Nexus C9336PQ (ACI mode)</h1>
<ol>
  <li typeof="HowToSection" property="step"><h2 property="name">Start the console session.</h2>
    <details typeof="HowToStep" property="itemListElement">
      <summary tabindex="0" property="text" autofocus>Plug in serial cable to device from PC COM1 port</summary>
      </details>
    <details typeof="HowToStep" property="itemListElement">
      <summary tabindex="0" property="text">Open PuTTY and select "Serial" connection type, leave baud rate (Speed) and other settings as default.</summary>
      </details>
    <details typeof="HowToStep" property="itemListElement">
      <summary tabindex="0" property="text">Plug power into device and if a power button exists, turn it on.</summary>
      </details>
  </li>
  <li typeof="HowToSection" property="step"><h2 property="name">Boot up bypassing the admin password.</h2>
    <details open aria-expanded="true" typeof="HowToStep" property="itemListElement">
      <summary tabindex="0" property="text">Repeatedly press <em>Ctrl C</em> until you see the <samp>loader ></samp>&nbsp; prompt, then type the <em>dir</em> command:</summary>
      <blockquote role="log" aria-label="example"><samp>
loader > <span>dir</span>

bootflash::

  auto-s
  mem_log.txt.old.gz
  libmon.logs
  CpuUsage.Log
  disk_log.txt
  lxc
  urib_api_log.txt
  diag_bootup
  <span class="cyan">aci-n9000-dk9.13.2.6i.bin</span>
  lost+found
      </samp></blockquote>
    </details>
    <details open aria-expanded="true" typeof="HowToStep" property="itemListElement">
      <summary tabindex="0" property="text">Type the <em>cmdline recoverymode=1</em> command then the <em>boot</em> command followed by the .bin file highlighted in blue above:</summary>
      <blockquote role="log" aria-label="example"><samp>
loader > <span>cmdline recoverymode=1</span>

loader > <span>boot aci-n9000-dk9.13.2.6i.bin</span>
Booting aci-n9000-dk9.13.2.6i.bin
Trying diskboot
 Filesystem type is ext2fs, partition type 0x83
Image valid


Image Signature verification was Successful.

Boot Time: 7/10/2024  1:53:37
      </samp></blockquote>
    </details>
    <details typeof="HowToStep" property="itemListElement">
      <summary tabindex="0" typeof="HowToTip" property="itemListElement"><span property="text">Further output will bring you to the <samp>(none) login:</samp>&nbsp;prompt.</span></summary>
    </details>
  </li>
  <li typeof="HowToSection" property="step"><h2 property="name">Erase configuration.</h2>
    <details open aria-expanded="true" typeof="HowToStep" property="itemListElement">
      <summary tabindex="0" property="text">Type <em>admin</em> for the login, then type the <em>setup-clean-config.sh</em> command:</summary>
      <blockquote role="log" aria-label="example"><samp>
(none) login: <span>admin</span>
********************************************************************************
     Fabric discovery in progress, show commands are not fully functional
     Logout and Login after discovery to continue to use show commands.
********************************************************************************
(none)# <span>setup-clean-config.sh</span>
In progress
[  303.470102] t2usd_tor (16064) Ran 5414 msecs in last 5476 msecs
In progress
[  308.962867] t2usd_tor (16064) Ran 5394 msecs in last 5420 msecs
In progress
[  314.965663] t2usd_tor (16064) Ran 5897 msecs in last 5932 msecs
In progress
In progress
In progress
In progress
In progress
Done
      </samp></blockquote>
    </details>
    <details open aria-expanded="true" typeof="HowToStep" property="itemListElement">
      <summary tabindex="0" property="text">Type the <em>ls -al /bootflash/aci-n9000-dk9*</em> command then <em>setup-bootvars.sh</em> followed by the .bin file shown:</summary>
      <blockquote role="log" aria-label="example"><samp>
(none)# <span>ls -al /bootflash/aci-n9000-dk9*</span>
-rw-rw-rw- 1 root root 1450820176 Jul  4  2019 /bootflash/aci-n9000-dk9.13.2.6i.bin
(none)# <span>setup-bootvars.sh aci-n9000-dk9.13.2.6i.bin</span>
In progress
In progress
In progress
In progress
In progress
In progress
[  393.939908] vsh_lc.bin (29162) Ran 4971 msecs in last 5092 msecs
In progress
Done
      </samp></blockquote>
    </details>
    <details open aria-expanded="true" typeof="HowToStep" property="itemListElement">
      <summary tabindex="0" typeof="HowToTip" property="itemListElement"><span property="text">You can check that it is correctly added as the startup boot file with the <em>cat /mnt/cfg/0/boot/grub/menu.lst.local</em> and <em>cat /mnt/cfg/1/boot/grub/menu.lst.local</em> commands:</span></summary>
      <blockquote role="log" aria-label="example"><samp>
(none)# <span>cat /mnt/cfg/0/boot/grub/menu.lst.local</span>
boot aci-n9000-dk9.13.2.6i.bin
(none)# <span>cat /mnt/cfg/1/boot/grub/menu.lst.local</span>
boot aci-n9000-dk9.13.2.6i.bin
      </samp></blockquote>
    </details>
  </li>
  <li typeof="HowToSection" property="step"><h2 property="name">Reboot the device.</h2>
    <details open aria-expanded="true" typeof="HowToStep" property="itemListElement">
      <summary tabindex="0" property="text">Type the <em>acidiag touch clean</em> and <em>acidiag touch setup</em> commands followed by the <em>reload</em> command, confirming with <em>y</em>:</summary>
      <blockquote role="log" aria-label="example"><samp>
(none)# <span>acidiag touch clean</span>
This command will wipe out this device, Proceed? [y/N] <span>y</span>
(none)# <span>acidiag touch setup</span>
(none)# <span>reload</span>
This command will reload the chassis, Proceed (y/n)? [n]: <span>y</span>
[  491.029328] (1720576907.871177) (07-10-2024 02:01:47 UTC) sys_srvc_cctrl_diag_test: dbg_caller_id is 2
[  491.029430] (1720576907.871281) (07-10-2024 02:01:47 UTC) sys_srvc_cctrl_diag_test: dbg_caller_id is 3
[  491.029433] cctrl_cmn_reset_sfp_qsfp_phy_ports: cctrli2: card_index 21500 not supported
[  491.029438] (1720576907.871291) (07-10-2024 02:01:47 UTC)cctrl2 card_index=21500, link flap not done.
(none)# nvram_klm wrote rr=9 rr_str=PolicyElem Ch reload to nvram
[  497.137253] Collected 8 ext4 filesystems
[  497.187158] Freezing filesystems
[  497.369182] Collected 1 ubi filesystems
[  497.415986] Freezing filesystems
[  497.456567] Done freezing filesystems
[  497.502325] Putting SSD in stdby
[  497.719360] Done putting SSD in stdby 0
[  497.766140] Done offlining SSD
[  497.803581] obfl_klm writing reset reason 9, PolicyElem Ch reload
[  498.875137] write_mtd_flash_panic: successfully wrote 88 bytes at address 0x420 to RR Iter: 0.
[
CISCO SWITCH Ver7.64
      </samp></blockquote>
    </details>
  </li>
  <li typeof="HowToSection" property="step"><h2 property="name">Copy all the output from the session into your records.</h2>
    <details typeof="HowToStep" property="itemListElement">
      <summary tabindex="0" property="text">Right-click PuTTY's titlebar, from that dropdown menu click on "Copy All to Clipboard"</summary>
      </details>
    <details typeof="HowToStep" property="itemListElement">
      <summary tabindex="0" property="text">Open the file of record certifying the deconfiguration of this device and use <em>CTRL V</em> to paste all the output from PuTTY into that file. Formatting the text with a fixed-width font helps it look more readable.</summary>
    </details>
  </li>
  <li typeof="HowToSection" property="step"><h2 property="name">End the session.</h2>
    <details typeof="HowToStep" property="itemListElement">
      <summary tabindex="0" property="text">Close PuTTy.</summary>
    </details>
  </li>
</ol>
</main></body></html>
